import numpy as np
import pandas as pd

df = pd.read_csv('data_microdados.csv', sep = ',', encoding = 'utf-8', engine='python')
df.columns = [x.upper() for x in df.columns]
pd.set_option('display.max_columns', None)

df = df.rename(columns={'P1_A': 'Idade',
                        'P1_A_1': 'Faixa idade',
                        'P1_B': 'gênero',
                        'P1_C': 'Cor/raca/etnia', 
                        'P1_D': 'Pcd',
                        'P1_E': 'Experiência profissional prejudicada',
                        'P1_F': 'Aspectos prejudicados',
                        'P1_G': 'Vive no brasil',
                        'P1_I': 'Estado onde mora',
                        'P1_I_1': 'Uf onde mora',
                        'P1_I_2': 'Região onde mora',
                        'P1_J': 'Mudou de estado?',
                        'P1_K': 'Regiao de origem',
                        'P1_L': 'Nivel de ensino',
                        'P1_M': 'Área de formação',
                        'P2_A':	'Não Qual sua situação atual de trabalho?',
                        'P2_B':	'Setor',
                        'P2_C':	'Numero de funcionarios',
                        'P2_D':	'Gestor?',
                        'P2_E':	'Cargo como gestor',
                        'P2_F':	'Cargo atual',
                        'P2_G':	'Nivel',
                        'P2_H':	'Faixa salarial',
                        'P2_I':	'Quanto tempo de experiência na área de dados você tem?',
                        'P2_J':	'Quanto tempo de experiência na área de ti/engenharia de software você teve antes de começar a trabalhar na área de dados?',
                        'P2_K':	'Você está satisfeito na sua empresa atual?',
                        'P2_L':	'Qual o principal motivo da sua insatisfação com a empresa atual?',
                        'P2_L_1': 'Falta de oportunidade de crescimento no emprego atual',
                        'P2_L_2': 'Salário atual não corresponde ao mercado',
                        'P2_L_3':	'Não tenho uma boa relação com meu líder/gestor',
                        'P2_L_4':	'Gostaria de trabalhar em em outra área de atuação',
                        'P2_L_5':	'Gostaria de receber mais benefícios',
                        'P2_L_6':	'O clima de trabalho/ambiente não é bom',
                        'P2_L_7':	'Falta de maturidade analítica na empresa',
                        'P2_M':	'Você participou de entrevistas de emprego nos últimos 6 meses?',
                        'P2_N':	'Você pretende mudar de emprego nos próximos 6 meses?',
                        'P2_O':	'Quais os principais critérios que você leva em consideração no momento de decidir onde trabalhar?',
                        'P2_O_1':	'Remuneração/salário',
                        'P2_O_2':	'Benefícios',
                        'P2_O_3':	'Propósito do trabalho e da empresa',
                        'P2_O_4':	'Flexibilidade de trabalho remoto',
                        'P2_O_5':	'Ambiente e clima de trabalho',
                        'P2_O_6':	'Oportunidade de aprendizado e trabalhar com referências na área',
                        'P2_O_7':	'Plano de carreira e oportunidades de crescimento profissional',
                        'P2_O_8':	'Maturidade da empresa em termos de tecnologia e dados',
                        'P2_O_9':	'Qualidade dos gestores e líderes',
                        'P2_O_10':	'Reputação que a empresa tem no mercado',
                        'P2_P':	'Atualmente qual a sua forma de trabalho?',
                        'P2_Q':	'Qual a forma de trabalho ideal para você?',
                        'P2_R':	'Caso sua empresa decida pelo modelo 100% presencial qual será sua atitude?',
                        'P2_S':	'Sua empresa passu por layoff em 2022?',
                        'P3_A':	'Qual o número aproximado de pessoas que atuam com dados na sua empresa hoje?',
                        'P3_B':	'Quais desses papéis/cargos fazem parte do time (ou chapter) de dados da sua empresa?',
                        'P3_B_1':	'Analytics engineer',
                        'P3_B_2':	'Engenharia de dados/data engineer',
                        'P3_B_3':	'Analista de dados/data analyst',
                        'P3_B_4':	'Cientista de dados/data scientist',
                        'P3_B_5':	'Database administrator/dba',
                        'P3_B_6':	'Analista de business intelligence/bi',
                        'P3_B_7':	'Arquiteto de dados/data architect',
                        'P3_B_8':	'Data product manager/dpm',
                        'P3_B_9':	'Business analyst',
                        'P3_C':	'Quais dessas responsabilidades fazem parte da sua rotina atual de trabalho como gestor?',
                        'P3_C_1':	'Pensar na visão de longo prazo de dados da empresa e fortalecimento da cultura analítica da companhia.',
                        'P3_C_2':	'Organização de treinamentos e iniciativas com o objetivo de aumentar a maturidade analítica das áreas de negócios.',
                        'P3_C_3':	'Atração',
                        'P3_C_4':	'Decisão sobre contratação de ferramentas e tecnologias relacionadas a dados.',
                        'P3_C_5':	'Sou gestor da equipe responsável pela engenharia de dados e por manter o data lake da empresa como fonte única dos dados',
                        'P3_C_6':	'Sou gestor da equipe responsável pela entrega de dados',
                        'P3_C_7':	'Sou gestor da equipe responsável por iniciativas e projetos envolvendo inteligência artificial e machine learning.',
                        'P3_C_8':	'Apesar de ser gestor ainda atuo na parte técnica',
                        'P3_C_9':	'Gestão de projetos de dados',
                        'P3_C_10':	'Gestão de produtos de dados',
                        'P3_C_11':	'Gestão de pessoas',
                        'P3_D':	'Quais são os 3 maiores desafios que você tem como gestor no atual momento?',
                        'P3_D_1':	'Contratar novos talentos.',
                        'P3_D_2':	'Reter talentos.',
                        'P3_D_3':	'Convencer a empresa a aumentar os investimentos na área de dados.',
                        'P3_D_4':	'Gestão de equipes no ambiente remoto.',
                        'P3_D_5':	'Gestão de projetos envolvendo áreas multidisciplinares da empresa.',
                        'P3_D_6':	'Organizar as informações e garantir a qualidade e confiabilidade.',
                        'P3_D_7':	'Conseguir processar e armazenar um alto volume de dados.',
                        'P3_D_8':	'Conseguir gerar valor para as áreas de negócios através de estudos e experimentos.',
                        'P3_D_9':	'Desenvolver e manter modelos machine learning em produção.',
                        'P3_D_10':	'Gerenciar a expectativa das áreas de negócio em relação as entregas das equipes de dados.',
                        'P3_D_11':	'Garantir a manutenção dos projetos e modelos em produção',
                        'P3_D_12':	'Conseguir levar inovação para a empresa através dos dados.',
                        'P3_D_13':	'Garantir retorno do investimento (roi) em projetos de dados.',
                        'P3_D_14':	'Dividir o tempo entre entregas técnicas e gestão.',
                        'P4_A':	'Mesmo que esse não seja seu cargo formal',
                        'P4_A_1':	'Atuacao',
                        'P4_B':	'Quais das fontes de dados listadas você já analisou ou processou no trabalho?',
                        'P4_B_1':	'Dados relacionais (estruturados em bancos sql)',
                        'P4_B_2':	'Dados armazenados em bancos nosql',
                        'P4_B_3':	'Imagens',
                        'P4_B_4':	'Textos/documentos',
                        'P4_B_5':	'Vídeos',
                        'P4_B_6':	'Áudios',
                        'P4_B_7':	'Planilhas',
                        'P4_B_8':	'Dados georeferenciados',
                        'P4_C':	'Entre as fontes de dados listadas',
                        'P4_C_1':	'Dados relacionais (estruturados em bancos sql)',
                        'P4_C_2':	'Dados armazenados em bancos nosql',
                        'P4_C_3':	'Imagens',
                        'P4_C_4':	'Textos/documentos',
                        'P4_C_5':	'Vídeos',
                        'P4_C_6':	'Áudios',
                        'P4_C_7':	'Planilhas',
                        'P4_C_8':	'Dados georeferenciados',
                        'P4_D':	'Quais das linguagens listadas abaixo você utiliza no trabalho?',
                        'P4_D_1':	'Sql',
                        'P4_D_2':	'R',
                        'P4_D_3':	'Python',
                        'P4_D_4':	'C/c++/c#',
                        'P4_D_5':	'.net',
                        'P4_D_6':	'Java',
                        'P4_D_7':	'Julia',
                        'P4_D_8':	'Sas/stata',
                        'P4_D_9':	'Visual basic/vba',
                        'P4_D_10':	'Scala',
                        'P4_D_11':	'Matlab',
                        'P4_D_12':	'Php',
                        'P4_D_13':	'Javascript',
                        'P4_D_14':	'Não utilizo nenhuma linguagem',
                        'P4_E':	'Entre as linguagens listadas abaixo',
                        'P4_F':	'Entre as linguagens listadas abaixo',
                        'P4_G':	'Quais dos bancos de dados/fontes de dados listados abaixo você utiliza no trabalho?',
                        'P4_G_1':	'Mysql',
                        'P4_G_2':	'Oracle',
                        'P4_G_3':	'Sql server',
                        'P4_F_4':	'Amazon aurora ou rds',
                        'P4_F_5':	'Dynamodb',
                        'P4_F_6':	'Coachdb',
                        'P4_F_7':	'Cassandra',
                        'P4_F_8':	'Mongodb',
                        'P4_F_9':	'Mariadb',
                        'P4_F_10':	'Datomic',
                        'P4_F_11':	'S3',
                        'P4_F_12':	'Postgresql',
                        'P4_F_13':	'Elasticsearch',
                        'P4_F_14':	'Db2',
                        'P4_F_15':	'Microsoft access',
                        'P4_F_16':	'Sqlite',
                        'P4_F_17':	'Sybase',
                        'P4_F_18':	'Firebase',
                        'P4_F_19':	'Vertica',
                        'P4_F_20':	'Redis',
                        'P4_F_21':	'Neo4j',
                        'P4_F_22':	'Google bigquery',
                        'P4_F_23':	'Google firestore',
                        'P4_F_24':	'Amazon redshift',
                        'P4_F_25':	'Amazon athena',
                        'P4_F_26':	'Snowflake',
                        'P4_F_27':	'Databricks',
                        'P4_F_28':	'Hbase',
                        'P4_F_29':	'Presto',
                        'P4_F_30':	'Splunk',
                        'P4_F_31':	'Sap hana',
                        'P4_F_32':	'Hive',
                        'P4_F_33':	'Firebird',
                        'P4_G__1':	'Quais das opções de cloud listadas abaixo você utiliza no trabalho?',
                        'P4_H':	'Dentre as opções listadas',
                        'P4_H_1':	'Azure (microsoft)',
                        'P4_H_2':	'Amazon web services (aws)',
                        'P4_H_3':	'Google cloud (gcp)',
                        'P4_I':	'Microsoft powerbi',
                        'P4_I_1':	'Microsoft powerbi',
                        'P4_I_2':	'Qlik view/qlik sense',
                        'P4_I_3':	'Tableau',
                        'P4_I_4':	'Metabase',
                        'P4_I_5':	'Superset',
                        'P4_I_6':	'Redash',
                        'P4_I_7':	'Microstrategy',
                        'P4_I_8':	'Ibm analytics/cognos',
                        'P4_I_9':	'Sap business objects',
                        'P4_I_10':	'Oracle business intelligence',
                        'P4_I_11':	'Amazon quicksight',
                        'P4_I_12':	'Salesforce/einstein analytics',
                        'P4_I_13':	'Mode',
                        'P4_I_14':	'Alteryx',
                        'P4_I_15':	'Birst',
                        'P4_I_16':	'Looker',
                        'P4_I_17':	'Google data studio',
                        'P4_I_18':	'Sas visual analytics',
                        'P4_I_19':	'Grafana',
                        'P4_I_20':	'Tibco spotfire',
                        'P4_I_21':	'Pentaho',
                        'P4_I_22':	'Fazemos todas as análises utilizando apenas excel ou planilhas do google',
                        'P4_I_23':	'Não utilizo nenhuma ferramenta de bi no trabalho',
                        'P5_A':	'Qual seu objetivo na área de dados?',
                        'P5_B':	'Qual oportunidade você está buscando?',
                        'P5_C':	'Há quanto tempo você busca uma oportunidade na área de dados?',
                        'P5_D':	'Como tem sido a busca por um emprego na área de dados?',
                        'P6_A':	'Quais das opções abaixo fazem parte da sua rotina no trabalho atual como engenheiro de dados?',
                        'P6_A_1':	'Desenvolvo pipelines de dados utilizando linguagens de programação como python',
                        'P6_A_2':	'Realizo construções de etls em ferramentas como pentaho',
                        'P6_A_3':	'Crio consultas através da linguagem sql para exportar informações e compartilhar com as áreas de negócio.',
                        'P6_A_4':	'Atuo na integração de diferentes fontes de dados através de plataformas proprietárias como stitch data',
                        'P6_A_5':	'Modelo soluções de arquitetura de dados',
                        'P6_A_6':	'Desenvolvo/cuido da manutenção de repositórios de dados baseados em streaming de eventos como data lakes e data lakehouses.',
                        'P6_A_7':	'Atuo na modelagem dos dados',
                        'P6_A_8':	'Cuido da qualidade dos dados',
                        'P6_A_9':	'Nenhuma das opções listadas refletem meu dia a dia.',
                        'P6_B':	'Quais as ferramentas/tecnologias de etl que você utiliza no trabalho como data engineer?',
                        'P6_B_1':	'Scripts python',
                        'P6_B_2':	'Sql & stored procedures',
                        'P6_B_3':	'Apache airflow',
                        'P6_B_4':	'Luigi',
                        'P6_B_5':	'Aws glue',
                        'P6_B_6':	'Talend',
                        'P6_B_7':	'Pentaho',
                        'P6_B_8':	'Alteryx',
                        'P6_B_9':	'Stitch',
                        'P6_B_10':	'Fivetran',
                        'P6_B_11':	'Google dataflow',
                        'P6_B_12':	'Oracle data integrator',
                        'P6_B_13':	'Ibm datastage',
                        'P6_B_14':	'Sap bw etl',
                        'P6_B_15':	'Sql server integration services (ssis)',
                        'P6_B_16':	'Sas data integration',
                        'P6_B_17':	'Qlik sense',
                        'P6_B_18':	'Knime',
                        'P6_B_19':	'Databricks',
                        'P6_B_19__1':	'Não utilizo ferramentas de etl',
                        'P6_C':	'Sua organização possui um data lake?',
                        'P6_D':	'Qual tecnologia utilizada como plataforma do data lake?',
                        'P6_E':	'Sua organização possui um data warehouse?',
                        'P6_F':	'Qual tecnologia utilizada como plataforma do data warehouse?',
                        'P6_G':	'Quais as ferramentas de gestão de qualidade de dados',
                        'P6_G_1':	'Great expectations',
                        'P6_G_2':	'Dbt',
                        'P6_G_3':	'Aws deequ',
                        'P6_G_4':	'Apache griffin',
                        'P6_G_5':	'Datafold',
                        'P6_G_6':	'Amundsen',
                        'P6_G_7':	'Monte carlo',
                        'P6_G_8':	'Soda',
                        'P6_G_9':	'Big eye',
                        'P6_G_10':	'Data band',
                        'P6_G_11':	'Anomalo',
                        'P6_G_L':	'Metaplane',
                        'P6_G_M':	'Acceldata',
                        'P6_H':	'Em qual das opções abaixo você gasta a maior parte do seu tempo?',
                        'P6_H_1':	'Desenvolvendo pipelines de dados utilizando linguagens de programação como python',
                        'P6_H_2':	'Realizando construções de etls em ferramentas como pentaho',
                        'P6_H_3':	'Criando consultas através da linguagem sql para exportar informações e compartilhar com as áreas de negócio.',
                        'P6_H_4':	'Atuando na integração de diferentes fontes de dados através de plataformas proprietárias como stitch data',
                        'P6_H_5':	'Modelando soluções de arquitetura de dados',
                        'P6_H_6':	'Desenvolvendo/cuidando da manutenção de repositórios de dados baseados em streaming de eventos como data lakes e data lakehouses.',
                        'P6_H_7':	'Atuando na modelagem dos dados',
                        'P6_H_8':	'Cuidando da qualidade dos dados',
                        'P6_H_9':	'Nenhuma das opções listadas refletem meu dia a dia.',
                        'P7_1':	'Quais das opções abaixo fazem parte da sua rotina no trabalho atual com análise de dados?',
                        'P7_A_1':	'Processo e analiso dados utilizando linguagens de programação como python',
                        'P7_A_2':	'Realizo construções de dashboards em ferramentas de bi como powerbi',
                        'P7_A_3':	'Crio consultas através da linguagem sql para exportar informações e compartilhar com as áreas de negócio.',
                        'P7_A_4':	'Utilizo apis para extrair dados e complementar minhas análises.',
                        'P7_A_5':	'Realizo experimentos e estudos utilizando metodologias estatísticas como teste de hipótese',
                        'P7_A_6':	'Desenvolvo/cuido da manutenção de etls utilizando tecnologias como talend',
                        'P7_A_7':	'Atuo na modelagem dos dados',
                        'P7_A_8':	'Desenvolvo/cuido da manutenção de planilhas para atender as áreas de negócio.',
                        'P7_A_9':	'Utilizo ferramentas avançadas de estatística como sas',
                        'P7_A_10':	'Nenhuma das opções listadas refletem meu dia a dia.',
                        'P7_B':	'Quais as ferramentas/tecnologias de etl que você utiliza no trabalho como data analyst?',
                        'P7_B_1':	'Scripts python',
                        'P7_B_2':	'Sql & stored procedures',
                        'P7_B_3':	'Apache airflow',
                        'P7_B_4':	'Luigi',
                        'P7_B_5':	'Aws glue',
                        'P7_B_6':	'Talend',
                        'P7_B_7':	'Pentaho',
                        'P7_B_8':	'Alteryx',
                        'P7_B_9':	'Stitch',
                        'P7_B_10':	'Fivetran',
                        'P7_B_11':	'Google dataflow',
                        'P7_B_12':	'Oracle data integrator',
                        'P7_B_13':	'Ibm datastage',
                        'P7_B_14':	'Sap bw etl',
                        'P7_B_15':	'Sql server integration services (ssis)',
                        'P7_B_16':	'Sas data integration',
                        'P7_B_17':	'Qlik sense',
                        'P7_B_18':	'Knime',
                        'P7_B_19':	'Databricks',
                        'P7_B_20':	'Não utilizo ferramentas de etl',
                        'P7_C':	'Sua empresa utiliza alguma das ferramentas listadas para dar mais autonomia em análise de dados para as áreas de negócio?',
                        'P7_C_1':	'Ferramentas de automl como h2o.ai',
                        'P7_C_2':	'""point and click"" analytics como alteryx',
                        'P7_C_3':	'Product metricts & insights como mixpanel',
                        'P7_C_4':	'Ferramentas de análise dentro de ferramentas de crm como salesforce einstein anaytics ou zendesk dashboards.',
                        'P7_C_5':	'Minha empresa não utiliza essas ferramentas.',
                        'P7_C_6':	'Não sei informar.',
                        'P7_D':	'Em qual das opções abaixo você gasta a maior parte do seu tempo de trabalho?',
                        'P7_D_1':	'Processando e analisando dados utilizando linguagens de programação como python',
                        'P7_D_2':	'Realizando construções de dashboards em ferramentas de bi como powerbi',
                        'P7_D_3':	'Criando consultas através da linguagem sql para exportar informações e compartilhar com as áreas de negócio.',
                        'P7_D_4':	'Utilizando apis para extrair dados e complementar minhas análises.',
                        'P7_D_5':	'Realizando experimentos e estudos utilizando metodologias estatísticas como teste de hipótese',
                        'P7_D_6':	'Desenvolvendo/cuidando da manutenção de etls utilizando tecnologias como talend',
                        'P7_D_7':	'Atuando na modelagem dos dados',
                        'P7_D_8':	'Desenvolvendo/cuidando da manutenção de planilhas do excel ou google sheets para atender as áreas de negócio.',
                        'P7_D_9':	'Utilizando ferramentas avançadas de estatística como sas',
                        'P7_D_10':	'Nenhuma das opções listadas refletem meu dia a dia.',
                        'P8_A':	'Quais das opções abaixo fazem parte da sua rotina no trabalho atual com ciência de dados?',
                        'P8_A_1':	'Estudos ad-hoc com o objetivo de confirmar hipóteses',
                        'P8_A_2':	'Sou responsável pela coleta e limpeza dos dados que uso para análise e modelagem.',
                        'P8_A_3':	'Sou responsável por entrar em contato com os times de negócio para definição do problema',
                        'P8_A_4':	'Desenvolvo modelos de machine learning com o objetivo de colocar em produção em sistemas (produtos de dados).',
                        'P8_A_5':	'Sou responsável por colocar modelos em produção',
                        'P8_A_6':	'Cuido da manutenção de modelos de machine learning já em produção',
                        'P8_A_7':	'Realizo construções de dashboards em ferramentas de bi como powerbi',
                        'P8_A_8':	'Utilizo ferramentas avançadas de estatística como sas',
                        'P8_A_9':	'Crio e dou manutenção em etls',
                        'P8_A_10':	'Crio e gerencio soluções de feature store e cultura de mlops.',
                        'P8_A_11':	'Sou responsável por criar e manter a infra que meus modelos e soluções rodam (clusters',
                        'P8_B':	'Quais as técnicas e métodos listados abaixo você costuma utilizar no trabalho?',
                        'P8_B_1':	'Utilizo modelos de regressão (linear',
                        'P8_B_2':   'Utilizo redes neurais ou modelos baseados em árvore para criar modelos de classificação',
                        'P8_B_3':	'Desenvolvo sistemas de recomendação (recsys)',
                        'P8_B_4':	'Utilizo métodos estatísticos bayesianos para analisar dados',
                        'P8_B_5':	'Utilizo técnicas de nlp (natural language processing) para análisar dados não-estruturados',
                        'P8_B_6':	'Utilizo métodos estatísticos clássicos (testes de hipótese',
                        'P8_B_7':	'Utilizo cadeias de markov ou hmms para realizar análises de dados',
                        'P8_B_8':	'Desenvolvo técnicas de clusterização (k-means',
                        'P8_B_9':	'Realizo previsões através de modelos de séries temporais (time series)',
                        'P8_B_10':	'Utilizo modelos de reinforcement learning (aprendizado por reforço)',
                        'P8_B_11':	'Utilizo modelos de machine learning para detecção de fraude',
                        'P8_B_L':	'Utilizo métodos de visão computacional',
                        'P8_B_M':	'Utilizo modelos de detecção de churn',
                        'P8_3':	'Quais dessas tecnologias fazem parte do seu dia a dia como cientista de dados?',
                        'P8_C_1':	'Ferramentas de bi (powerbi',
                        'P8_C_2':	'Planilhas (excel',
                        'P8_C_3':	'Ambientes de desenvolvimento local (r-studio',
                        'P8_C_4':	'Ambientes de desenvolvimento na nuvem (google colab',
                        'P8_C_5':	'Ferramentas de automl (datarobot',
                        'P8_C_6':	'Ferramentas de etl (apache airflow',
                        'P8_C_7':	'Plataformas de machine learning (tensorflow',
                        'P8_C_8':	'Feature store (feast',
                        'P8_C_9':	'Sistemas de controle de versão (github',
                        'P8_C_10':	'Plataformas de data apps (streamlit',
                        'P8_C_11':	'Ferramentas de estatística avançada como spss',
                        'P8_D':	'Em qual das opções abaixo você gasta a maior parte do seu tempo no trabalho?',
                        'P8_D_1':	'Estudos ad-hoc com o objetivo de confirmar hipóteses',
                        'P8_D_2':	'Coletando e limpando os dados que uso para análise e modelagem.',
                        'P8_D_3':	'Entrando em contato com os times de negócio para definição do problema',
                        'P8_D_4':	'Desenvolvendo modelos de machine learning com o objetivo de colocar em produção em sistemas (produtos de dados).',
                        'P8_D_5':	'Colocando modelos em produção',
                        'P8_D_6':	'Cuidando da manutenção de modelos de machine learning já em produção',
                        'P8_D_7':	'Realizando construções de dashboards em ferramentas de bi como powerbi',
                        'P8_D_8':	'Utilizando ferramentas avançadas de estatística como sas',
                        'P8_D_9':	'Criando e dando manutenção em etls',
                        'P8_D_10':	'Criando e gerenciando soluções de feature store e cultura de mlops.',
                        'P8_D_11':	'Criando e mantendo a infra que meus modelos e soluções rodam (clusters)'}).drop('P0', axis=1)

df = df.fillna(0).sort_values('Idade', ascending=False).reset_index(drop=True)

